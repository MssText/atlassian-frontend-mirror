## API Report File for "@atlaskit/ufo"

> Do not edit this file. It is a report generated by [API Extractor](https://api-extractor.com/).

```ts
declare type AbstractExperienceConfig = {
  category?: string | null;
  until?: Function | null;
  type: ExperienceTypes;
  performanceType: ExperiencePerformanceTypes;
  platform?: {
    component: string;
  };
  featureFlags?: string[];
  isSSROutputAsFMP?: boolean;
  timings?: Timing[];
  performanceConfig?: PerformanceConfig;
};

declare type BasePageLoadHistogramConfig = {
  [PageLoadMetrics.fmp]: string;
  [PageLoadMetrics.tti]: string;
};

declare type BasePageSegmentLoadHistogramConfig = {
  [PageSegmentLoadMetrics.fmp]: string;
  [PageSegmentLoadMetrics.tti]: string;
};

export declare class ConcurrentExperience {
  experienceId: string;
  config: AbstractExperienceConfig;
  instances: {
    [key: string]: UFOExperience;
  };
  constructor(experienceId: string, config: AbstractExperienceConfig);
  getInstance(instanceId: string): UFOExperience;
  release(instanceId: string): void;
}

export declare type CustomData = {
  [key: string]: string | number | boolean | CustomData | undefined;
};

declare type CustomHistogramConfig = {
  [CustomMetrics.duration]: string;
};

declare enum CustomMetrics {
  duration = 'duration',
}

declare type EndStateConfig = {
  force?: boolean;
  metadata?: CustomData;
};

declare interface ExperienceData {
  id: string;
  uuid: string | null;
  type: ExperienceTypes;
  schemaVersion: string;
  performanceType: ExperiencePerformanceTypes;
  category: string | null;
  state: UFOExperienceStateType;
  metadata: CustomData;
  metrics: ExperienceMetrics;
  children: Array<ExperienceData>;
  pageVisibleState: PageVisibleState;
  platform: {
    component: string;
  } | null;
  result: {
    success: boolean;
    startTime: number | null;
    duration: number;
  };
  featureFlags: string[];
  isSSROutputAsFMP: boolean;
  timings: Timing[];
  explicitTimings: ReportedTimings;
  performanceConfig?: PerformanceConfig;
}

declare type ExperienceMetrics = {
  startTime: null | number;
  endTime: null | number;
  marks: Array<{
    name: string;
    time: number;
  }>;
};

export declare const experiencePayloadEvent: (
  data: ExperienceData,
) => UFOGlobalEventStreamExperiencePayload;

export declare enum ExperiencePerformanceTypes {
  PageLoad = 'page-load',
  PageSegmentLoad = 'page-segment-load',
  InlineResult = 'inline-result',
  Custom = 'custom',
}

export declare enum ExperienceTypes {
  Load = 'load',
  Experience = 'experience',
  Operation = 'operation',
}

export declare const getGlobalEventStream: () => GlobalEventStream;

declare type GlobalEventStream = {
  push(event: UFOGlobalEventStreamEvent): void;
  __buffer_only__: boolean;
};

export declare const GlobalPageLoadExperience: UFOGlobalPageLoadExperience;

declare type HistogramConfig = {
  [ExperiencePerformanceTypes.PageLoad]?: PageLoadHistogramConfig;
  [ExperiencePerformanceTypes.PageSegmentLoad]?: PageSegmentLoadHistogramConfig;
  [ExperiencePerformanceTypes.InlineResult]?: InteractionHistogramConfig;
  [ExperiencePerformanceTypes.Custom]?: CustomHistogramConfig;
};

declare type InteractionHistogramConfig = {
  [InteractionMetrics.response]: string;
  [InteractionMetrics.result]: string;
};

declare enum InteractionMetrics {
  response = 'response',
  result = 'result',
}

declare interface PageLoadExperienceData extends ExperienceData {
  initial: boolean;
}

declare type PageLoadHistogramConfig = {
  initial: BasePageLoadHistogramConfig;
  transition: BasePageLoadHistogramConfig;
};

declare enum PageLoadMetrics {
  fmp = 'fmp',
  tti = 'tti',
}

declare type PageSegmentLoadHistogramConfig = {
  initial: BasePageSegmentLoadHistogramConfig;
  transition: BasePageSegmentLoadHistogramConfig;
};

declare enum PageSegmentLoadMetrics {
  fmp = 'fmp',
  tti = 'tti',
}

declare enum PageVisibleState {
  VISIBLE = 'visible',
  HIDDEN = 'hidden',
  MIXED = 'mixed',
}

declare type PerformanceConfig = {
  histogram?: HistogramConfig;
};

declare type ReportedTiming = {
  startTime: number;
  duration: number;
};

declare type ReportedTimings = {
  [key: string]: ReportedTiming;
};

export declare const setGlobalEventStream: (
  eventStream: GlobalEventStream,
) => void;

declare type SubscribeCallback = (data: ExperienceData) => void;

export declare const subscribeEvent: (
  experienceId: string,
  callback: SubscribeCallback,
) => UFOGlobalEventStreamSubscribe;

declare type Timing =
  | {
      key: string;
      startMark: string;
      endMark: string;
      component?: string;
    }
  | {
      key: string;
      endMark: string;
      component?: string;
    }
  | {
      key: string;
      startMark: string;
      component?: string;
    };

export declare const UFO_EXPERIMENTAL_BUILD_VERSION = '0.1.5';

declare class UFOAbstractExperience {
  state: UFOExperienceStateType;
  id: string;
  instanceId: null | string;
  parent: null | UFOAbstractExperience;
  category: null | string;
  type: ExperienceTypes;
  performanceType: ExperiencePerformanceTypes;
  metadata: CustomData;
  onDoneCallbacks: never[];
  childExperiences: never[];
  featureFlags: string[];
  timings: Timing[];
  explicitTimings: ReportedTimings;
  isSSROutputAsFMP: boolean;
  handleDoneBind: SubscribeCallback;
  uuid: string | null;
  until: Function | null;
  private _until;
  private pageVisibleState;
  metrics: ExperienceMetrics;
  performanceConfig: PerformanceConfig;
  config: AbstractExperienceConfig;
  constructor(
    id: string,
    config: AbstractExperienceConfig,
    instanceId?: null | string,
  );
  transition(
    newState: UFOExperienceStateType,
    timestamp?: number,
  ): Promise<boolean>;
  start(startTime?: number): Promise<void>;
  mark(name: string, timestamp?: number): void;
  private _mark;
  markFMP(timestamp?: number): void;
  markInlineResponse(timestamp?: number): void;
  private setPageVisibleStateToMixed;
  private _isManualStateEnabled;
  private _validateManualState;
  private switchToEndState;
  success(config?: EndStateConfig): Promise<boolean | null>;
  failure(config?: EndStateConfig): Promise<boolean | null>;
  abort(config?: EndStateConfig): Promise<boolean | null>;
  addMetadata(data: CustomData): void;
  private _handleDoneExperience;
  getId(): Promise<string>;
  exportData(): Promise<ExperienceData>;
  private _reset;
}

export declare class UFOExperience extends UFOAbstractExperience {}

export declare const UFOExperienceState: {
  [key: string]: UFOExperienceStateType;
};

declare type UFOExperienceStateType = {
  id: string;
  final?: boolean;
  success?: boolean;
};

declare type UFOGlobalEventStreamEvent =
  | UFOGlobalEventStreamExperiencePayload
  | UFOGlobalEventStreamSubscribe
  | UFOGlobalEventStreamUnsubscribe;

declare enum UFOGlobalEventStreamEventType {
  EXPERIENCE_PAYLOAD = 0,
  SUBSCRIBE = 1,
  UNSUBSCRIBE = 2,
}

declare type UFOGlobalEventStreamExperiencePayload = {
  type: UFOGlobalEventStreamEventType.EXPERIENCE_PAYLOAD;
  payload: ExperienceData;
};

declare type UFOGlobalEventStreamSubscribe = {
  type: UFOGlobalEventStreamEventType.SUBSCRIBE;
  payload: {
    experienceId: string;
    callback: SubscribeCallback;
  };
};

declare type UFOGlobalEventStreamUnsubscribe = {
  type: UFOGlobalEventStreamEventType.UNSUBSCRIBE;
  payload: {
    experienceId: string;
    callback: SubscribeCallback;
  };
};

declare class UFOGlobalPageLoadExperience extends UFOAbstractExperience {
  loadingPageLoadId: string;
  type: ExperienceTypes;
  performanceType: ExperiencePerformanceTypes;
  initial: boolean;
  startPageLoad(
    id: string,
    initial?: boolean,
    startTime?: number,
  ): Promise<void>;
  updateConfig(config: Partial<AbstractExperienceConfig>): void;
  setPageLoadId(id: string): void;
  getId(): Promise<string>;
  exportData(): Promise<PageLoadExperienceData>;
}

export declare const ufolog: (...args: Array<any>) => void;

declare class UFOLogger {
  enabled: boolean;
  static UFOprefix: string;
  log(...args: Array<any>): void;
  warn(...args: Array<any>): void;
  enable(): void;
  disable(): void;
}

export declare const ufologger: UFOLogger;

export declare const ufowarn: (...args: Array<any>) => void;

export declare const unsubscribeEvent: (
  experienceId: string,
  callback: SubscribeCallback,
) => UFOGlobalEventStreamUnsubscribe;

export declare const untilAll: (
  deps: UntilAllArgs,
) => () => (
  data: ExperienceData,
) =>
  | {
      done: boolean;
      state: UFOExperienceStateType;
    }
  | {
      done: boolean;
      state?: undefined;
    };

declare type UntilAllArgs = Array<UntilDefinition>;

declare type UntilCategory = {
  category: string;
};

declare type UntilDefinition = UntilExperience | UntilCategory;

declare type UntilExperience = {
  experience: UFOExperience;
};

declare class VisibilityChangeObserver {
  private started;
  private observers;
  private broadcast;
  start(): void;
  subscribe(callback: () => void): void;
  unsubscribe(callback: () => void): void;
}

export declare const visibilityChangeObserver: VisibilityChangeObserver;

export {};
```
